# cargo-deny configuration
# https://embarkstudios.github.io/cargo-deny/

[graph]
targets = []
all-features = false
no-default-features = false

# =============================================================================
# Advisories - check for known security vulnerabilities
# =============================================================================
[advisories]
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]
# How to handle unmaintained crates: "all", "workspace", "transitive", "none"
unmaintained = "workspace"
# How to handle yanked crates: "deny", "warn", "allow"
yanked = "deny"
# Ignore specific advisories (add with justification if needed)
ignore = [
  # tokio-tar vulnerability in testcontainers (dev dependency only, used in tests)
  # Waiting for testcontainers to update: https://rustsec.org/advisories/RUSTSEC-2025-0111
  "RUSTSEC-2025-0111",
]

# =============================================================================
# Licenses - ensure all dependencies use acceptable licenses
# =============================================================================
[licenses]
# Allow common permissive licenses (SPDX identifiers)
allow = [
  "MIT",
  "Apache-2.0",
  "Apache-2.0 WITH LLVM-exception",
  "BSD-2-Clause",
  "BSD-3-Clause",
  "ISC",
  "MPL-2.0",
  "Zlib",
  "Unicode-3.0",
  "CC0-1.0",
  "BSL-1.0",
  # CDLA-Permissive-2.0 is used by webpki-roots (root certificates data)
  "CDLA-Permissive-2.0",
]
# High confidence required for license detection
confidence-threshold = 0.8
# Specific license exceptions (add with justification if needed)
exceptions = []

[licenses.private]
ignore = false
registries = []

# =============================================================================
# Bans - control which crates are allowed
# =============================================================================
[bans]
# Warn on multiple versions of the same crate
multiple-versions = "warn"
# Deny wildcard dependencies
wildcards = "deny"
# Allow specific duplicates if needed
skip = []
skip-tree = []

# =============================================================================
# Sources - control where crates can come from
# =============================================================================
[sources]
unknown-registry = "deny"
unknown-git = "deny"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
allow-git = []
